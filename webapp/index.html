<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Sobriedad</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <h1>Bienvenido</h1>
            <div class="input-group">
                <input type="text" id="usernameInput" placeholder="Usuario" />
            </div>
            <div class="input-group">
                <input type="password" id="passwordInput" placeholder="Contrase√±a" />
            </div>
            <button class="btn btn-green" onclick="login()">Iniciar Sesi√≥n</button>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container" id="appContainer">
        <!-- Home Page -->
        <div class="home-page page active" id="homePage">
            <div class="counter-container">
                <div class="counter-label">D√≠as sobrio</div>
                <div class="counter" id="dayCounter">0</div>
                <div class="motivational-phrase" id="motivationalPhrase">Inicia un nuevo cambio</div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-item active" onclick="navigateTo('index.html')">
                <div class="nav-icon">üè†</div>
                <div class="nav-label">Home</div>
            </button>
            <button class="nav-item" onclick="navigateTo('calendar.html')">
                <div class="nav-icon">üìÖ</div>
                <div class="nav-label">Calendario</div>
            </button>
            <button class="nav-item" onclick="navigateTo('forum.html')">
                <div class="nav-icon">üí¨</div>
                <div class="nav-label">Foro</div>
            </button>
            <button class="nav-item" onclick="navigateTo('profile.html')">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">Perfil</div>
            </button>
        </div>
    </div>

    <script>
        let currentUser = null;
        let startDate = null;

        // Check if already logged in
        const savedUser = localStorage.getItem('currentUser');
        if (savedUser) {
            currentUser = savedUser;
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            loadData();
            updateCounter();
        }

        function login() {
            const username = document.getElementById('usernameInput').value;
            if (username.trim()) {
                currentUser = username;
                localStorage.setItem('currentUser', username);
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('appContainer').classList.add('active');
                loadData();
                updateCounter();
            }
        }

        function navigateTo(page) {
            window.location.href = page;
        }

        function updateCounter() {
            if (!startDate) {
                startDate = new Date();
                saveData();
            }

            const today = new Date();
            const diffTime = Math.abs(today - new Date(startDate));
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            document.getElementById('dayCounter').textContent = diffDays;
            updateMotivationalPhrase(diffDays);
        }

        function updateMotivationalPhrase(days) {
            let phrase = '';
            if (days === 0) phrase = 'Inicia un nuevo cambio';
            else if (days < 7) phrase = 'Un d√≠a a la vez, ¬°vas bien!';
            else if (days < 30) phrase = 'T√∫ puedes, sigue adelante';
            else if (days < 90) phrase = '¬°Excelente progreso! Sigue as√≠';
            else if (days < 180) phrase = '¬°Incre√≠ble! Eres m√°s fuerte de lo que crees';
            else phrase = '¬°Extraordinario! Eres un ejemplo de fortaleza';

            document.getElementById('motivationalPhrase').textContent = phrase;
        }

        function saveData() {
            const key = `sobrietyApp_${currentUser}`;
            const saved = localStorage.getItem(key);
            const data = saved ? JSON.parse(saved) : {};

            data.startDate = startDate;
            localStorage.setItem(key, JSON.stringify(data));
        }

        function loadData() {
            const key = `sobrietyApp_${currentUser}`;
            const saved = localStorage.getItem(key);

            if (saved) {
                const data = JSON.parse(saved);
                startDate = data.startDate ? new Date(data.startDate) : new Date();
            } else {
                startDate = new Date();
            }
        }

        setInterval(updateCounter, 60000);
    </script>
</body>
</html>