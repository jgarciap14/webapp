<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - App Sobriedad</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- App Container -->
    <div class="app-container active" id="appContainer">
        <!-- Home Page -->
        <div class="home-page page active" id="homePage">
            <div class="counter-container">
                <div class="counter-label">DÃ­as sobrio</div>
                <div class="counter" id="dayCounter">0</div>
                <div class="symptom-label" id="symptomLabel">Ansiedad</div>
                <div class="motivational-phrase" id="motivationalPhrase">Inicia un nuevo cambio</div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-item active" onclick="navigateTo('index.html')">
                <div class="nav-icon">ğŸ </div>
                <div class="nav-label">Home</div>
            </button>
            <button class="nav-item" onclick="navigateTo('calendar.html')">
                <div class="nav-icon">ğŸ“…</div>
                <div class="nav-label">Calendario</div>
            </button>
            <button class="nav-item" onclick="navigateTo('forum.html')">
                <div class="nav-icon">ğŸ’¬</div>
                <div class="nav-label">Foro</div>
            </button>
            <button class="nav-item" onclick="navigateTo('inspo.html')">
                <div class="nav-icon">â­</div>
                <div class="nav-label">Inspo</div>
            </button>
            <button class="nav-item" onclick="navigateTo('profile.html')">
                <div class="nav-icon">ğŸ‘¤</div>
                <div class="nav-label">Perfil</div>
            </button>
        </div>
    </div>

    <script>
        let currentUser = localStorage.getItem('currentUser');
        let persistentSession = localStorage.getItem('persistentSession');
        let startDate = null;

        // Redirect to login if not authenticated
        if (!currentUser || persistentSession !== 'true') {
            window.location.href = 'login.html';
        }

        // Update last activity timestamp to maintain session
        localStorage.setItem('lastActivity', new Date().toISOString());

        function navigateTo(page) {
            window.location.href = page;
        }

        function updateCounter() {
            if (!startDate) {
                startDate = new Date();
                saveData();
            }

            const today = new Date();
            const diffTime = Math.abs(today - new Date(startDate));
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            document.getElementById('dayCounter').textContent = diffDays;
            updateMotivationalPhrase(diffDays);
        }

        function updateMotivationalPhrase(days) {
            let phrase = '';
            let symptom = '';

            if (days === 0) {
                symptom = 'Inicio del cambio';
                phrase = 'Inicia un nuevo cambio';
            } else if (days === 1) {
                symptom = 'Temblores leves, ansiedad, nÃ¡useas y sudoraciÃ³n';
                phrase = 'Â¡Fuerza! Tu cuerpo estÃ¡ empezando a limpiarse. HidrÃ¡tate constantemente (agua o bebidas isotÃ³nicas) y trata de comer algo ligero, aunque no tengas apetito. Â¡Has superado el dÃ­a mÃ¡s difÃ­cil!';
            } else if (days >= 2 && days <= 3) {
                symptom = 'Insomnio, irritabilidad e inquietud. Antojos intensos';
                phrase = 'Â¡No estÃ¡s solo en esto! Intenta darte una ducha caliente para relajar los mÃºsculos. Escucha mÃºsica tranquila o un podcast para distraer tu mente. Llama a alguien de tu red de apoyo.';
            } else if (days >= 4 && days <= 5) {
                symptom = 'Niebla mental, dificultad para pensar con claridad, fatiga extrema y cambios de humor bruscos';
                phrase = 'SÃ© paciente contigo mismo. Tu cerebro estÃ¡ trabajando duro para reequilibrarse. Evita decisiones importantes. Escribe 3 cosas pequeÃ±as que puedas hacer hoy (ej: tender la cama, lavarte los dientes, comer una fruta).';
            } else if (days >= 6 && days <= 7) {
                symptom = 'Los temblores y nÃ¡useas disminuyen, pero la ansiedad y fatiga emocional pueden persistir';
                phrase = 'Â¡Felicidades por tu primera semana! Â¡Es un logro gigante! Trata de salir a caminar 10 minutos. El aire fresco y el movimiento ligero hacen maravillas.';
            } else if (days >= 8 && days <= 14) {
                symptom = 'Aburrimiento, apatÃ­a o sensaciÃ³n de vacÃ­o. El insomnio puede continuar';
                phrase = 'El aburrimiento es un disparador. Es vital crear una rutina simple. Establece horas fijas para dormir, despertar y comer. Busca una actividad que ocupe tus manos (dibujar, armar algo, cocinar).';
            } else if (days >= 15 && days <= 21) {
                symptom = 'Nube rosa: un optimismo excesivo, sintiendo que ya estÃ¡s curado';
                phrase = 'Â¡Es genial sentirse bien! DisfrÃºtalo, pero mantente alerta. Sigue conectado a tu terapia o grupo de apoyo. Recuerda por quÃ© empezaste este camino.';
            } else if (days >= 22 && days <= 30) {
                symptom = 'Los antojos pueden volver sorpresivamente, disparados por lugares, olores o emociones';
                phrase = 'Â¡Lograste un mes completo! Â¡IncreÃ­ble!. Si un antojo aparece, ponle un "temporizador". Dile "OK, te siento, pero voy a esperar 15 minutos". Usualmente, la intensidad bajarÃ¡.';
            } else if (days >= 31 && days <= 90) {
                symptom = 'Oleadas de ansiedad, irritabilidad o depresiÃ³n que parecen salir "de la nada". Problemas de memoria';
                phrase = 'Â¡Esto es normal! No significa que estÃ©s retrocediendo. Es tu cerebro sanando a un nivel mÃ¡s profundo. Habla sobre esto, no lo guardes. Â¡PasarÃ¡!';
            } else if (days >= 91 && days <= 180) {
                symptom = 'Dificultad para manejar el estrÃ©s. Sentimientos de impaciencia';
                phrase = 'La recuperaciÃ³n es un maratÃ³n. EstÃ¡s aprendiendo a vivir sin muletas. Es el momento perfecto para enfocarte en el manejo saludable del estrÃ©s: ejercicio regular, meditaciÃ³n o un nuevo hobby.';
            } else if (days >= 181 && days <= 270) {
                symptom = 'Exceso de confianza o complacencia';
                phrase = 'Â¡Mantente conectado! Tu red de apoyo es vital ahora. Ayudar a otros que estÃ¡n empezando (si te sientes listo) puede fortalecer tu propia recuperaciÃ³n. Â¡Celebra este medio aÃ±o!';
            } else if (days >= 271 && days <= 365) {
                symptom = 'Los viejos hÃ¡bitos de pensamiento pueden resurgir bajo estrÃ©s extremo';
                phrase = 'Â¡Un aÃ±o de sobriedad es un hito monumental! Has demostrado una fuerza increÃ­ble. Recuerda las herramientas que has aprendido. El estrÃ©s es parte de la vida, pero ahora tienes formas saludables de enfrentarlo. Â¡Sigue adelante!';
            } else {
                symptom = 'Estabilidad y fortaleza';
                phrase = 'Â¡Extraordinario! Eres un ejemplo de fortaleza y perseverancia. Has superado mÃ¡s de un aÃ±o de sobriedad.';
            }

            document.getElementById('symptomLabel').textContent = symptom;
            document.getElementById('motivationalPhrase').textContent = phrase;
        }

        function saveData() {
            const key = `sobrietyApp_${currentUser}`;
            const saved = localStorage.getItem(key);
            const data = saved ? JSON.parse(saved) : {};

            data.startDate = startDate;
            localStorage.setItem(key, JSON.stringify(data));
        }

        function loadData() {
            const key = `sobrietyApp_${currentUser}`;
            const saved = localStorage.getItem(key);

            if (saved) {
                const data = JSON.parse(saved);
                startDate = data.startDate ? new Date(data.startDate) : new Date();
            } else {
                startDate = new Date();
            }
        }

        // Initialize
        loadData();
        updateCounter();
        setInterval(updateCounter, 60000);
    </script>
</body>
</html>